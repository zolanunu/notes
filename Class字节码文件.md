## class字节码文件

### 相关命令查看

#### Javac -verbose 查看运行类是否加载了那些jar文件

helloc文件演示

```
javac -verbose helloc.java

java -verbose helloc // 可以看到虚拟机编译时做了哪些事情，可以看到虚拟机运行一个程序的时候加载的jar包

javac -help
```

#### javap 查看字节码

首先使用javap -help 可以查看到各种命令，各个命令什么作用

```
javap -c helloc // 查看字节码文件

javap -verbose // 可详细查看信息
```

### class字节码

java class字节码文件是编译后能够被java虚拟机所执行的一种平台中立的二进制格式表示文件。class文件格式中精确的定义了类和接口的表示形式，
包括在平台相关的目标文件格式中一些细节上的惯例。

java文件-----(java编译器)------> class文件 ------>字节码本地或者网络 -------------> 类加载器字节码的验证 (这里会有java类库的参与) 
---------> java解释器（即时编译器）-------->运行期系统 -----------> 操作系统 --------------> 硬件

从java解释器到运行期系统都是java虚拟机的部分

 由Java源文件编译生成字节码文件，这个过程非常复杂，学过《编译原理》的朋友都知道必须经过词法分析、语法分析、语义分析、中间代码生成、代码优化等；
 同样的，Java源文件到字节码的生成也想要经历这些步骤。
 Javac编译器的最后任务就是调用con.sun.tools.javac.jvm.Gen类将这课语法树编译为Java字节码文件。

其实，所谓的编译字节码，无非就是将符合Java语法规范的Java代码转化为符合JVM规范的字节码文件。JVM的架构模型是基于栈的，大部分都需要通过栈来完成。

字节码结构比较特殊，其内部不包含任何的分隔符，无法人工区分段落（字节码文件本身就是给机器读的），所以无论是字节顺序、数量都是有严格规定的，
所有16位、32位、64位长度的数据都将构造成2个、4个、8个-----8位字节单位来表示，
多字节数据项总是按照Big-endian顺序（高位字节在地址的最低位，地位字节在地址的最高位）来进行存储。

参考《Java虚拟机规范  Java SE7版》的描述，每一个字节码其实都对应着全局唯一的一个类或者接口的定义信息。

字节码文件才用的是一种类似于C语言结构体的伪结构来描述字节码文件格式。

字节码文件中对应的“基本类型”u1，u2，u4，u8分别表示无符号1、2、4、8个字节。

| type | descripe | remark |
|--|--|--|
| u4 |magic  |0xCAFEBABE |

值得一提的是，一个有效的class字节码文件的前4个字节为0xCAFEBABE,都是固定的，被称为“魔术”，即magic。
它就是JVM用于校验所读取的目标文件是否是一个有效且合法的字节码文件。
由此可见，JVM并不是通过判断文件后缀名的方式来校验，以防止人为手动修改。
